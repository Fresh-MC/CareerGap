- id: "A.1.a.i"
  title: "Enforce password complexity requirements"
  description: "Ensure password complexity policy is enabled"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "local_policy"
  policy_name: "PasswordComplexity"
  expected_state: "1"
  remediate_type: "local_policy_set"
  set_value: "1"
  post_reboot_required: false
  reference: "Annexure A Page 1, Item 1.a.i"
- id: "A.1.a.ii"
  title: "Set minimum password length"
  description: "Ensure minimum password length is at least 14 characters"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "local_policy"
  policy_name: "MinimumPasswordLength"
  expected_state:
    operator: "gte"
    value: 14
  remediate_type: "local_policy_set"
  set_value: 14
  post_reboot_required: false
  reference: "Annexure A Page 1, Item 1.a.ii"
- id: "A.1.a.iii"
  title: "Set maximum password age"
  description: "Ensure maximum password age is 60 days or less"
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "local_policy"
  policy_name: "MaximumPasswordAge"
  expected_state:
    operator: "lte"
    value: 60
  remediate_type: "local_policy_set"
  set_value: 60
  post_reboot_required: false
  reference: "Annexure A Page 1, Item 1.a.iii"
- id: "A.1.a.iv"
  title: "Set minimum password age"
  description: "Ensure minimum password age is at least 1 day"
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "local_policy"
  policy_name: "MinimumPasswordAge"
  expected_state:
    operator: "gte"
    value: 1
  remediate_type: "local_policy_set"
  set_value: 1
  post_reboot_required: false
  reference: "Annexure A Page 1, Item 1.a.iv"
- id: "A.1.a.v"
  title: "Store passwords using reversible encryption"
  description: "Ensure passwords are not stored using reversible encryption"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "local_policy"
  policy_name: "ClearTextPassword"
  expected_state: "0"
  remediate_type: "local_policy_set"
  set_value: "0"
  post_reboot_required: false
  reference: "Annexure A Page 1, Item 1.a.v"
- id: "A.1.a.vii"
  title: "Minimum password length audit"
  description: "Ensure minimum password length is set to 14 characters or more"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "local_policy"
  policy_name: "MinimumPasswordLength"
  expected_state:
    operator: "gte"
    value: 14
  remediate_type: "local_policy_set"
  set_value: 14
  post_reboot_required: false
  reference: "Annexure A Page 1, Item 1.a.vii"
- id: "A.1.a.viii"
  title: "Relax minimum password length limits"
  description: "Enable the relaxation of minimum password length limits to support passwords longer than 14 characters"
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "local_policy"
  policy_name: "RelaxMinimumPasswordLengthLimits"
  expected_state:
    operator: "eq"
    value: 1
  remediate_type: "local_policy_set"
  set_value: 1
  post_reboot_required: true
  reference: "Annexure A Page 1, Item 1.a.viii"
- id: "A.1.b.i"
  title: "Enforce password history"
  description: "Ensure password history remembers at least 24 passwords"
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "local_policy"
  policy_name: "PasswordHistorySize"
  expected_state:
    operator: "gte"
    value: 24
  remediate_type: "local_policy_set"
  set_value: 24
  post_reboot_required: false
  reference: "Annexure A Page 2, Item 1.b.i"
- id: "A.1.b.ii"
  title: "Enforce password history on all domain users"
  description: "Ensure password history is enforced across the domain"
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "local_policy"
  policy_name: "PasswordHistorySize"
  expected_state:
    operator: "gte"
    value: 24
  remediate_type: "local_policy_set"
  set_value: 24
  post_reboot_required: false
  reference: "Annexure A Page 2, Item 1.b.ii"
- id: "A.1.b.iii"
  title: "Reset account lockout counter after"
  description: "Ensure 'Reset account lockout counter after' is set to 15 minutes or more"
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "local_policy"
  policy_name: "ResetLockoutCount"
  expected_state:
    operator: "gte"
    value: 15
  remediate_type: "local_policy_set"
  set_value: 15
  post_reboot_required: false
  reference: "Annexure A Page 1, Item 1.b.iii"
- id: "A.2.a.i"
  title: "Disable Guest account"
  description: "Ensure Guest account is disabled"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "local_policy"
  policy_name: "EnableGuestAccount"
  expected_state: "0"
  remediate_type: "local_policy_set"
  set_value: "0"
  post_reboot_required: false
  reference: "Annexure A Page 3, Item 2.a.i"
- id: "A.2.a.ii"
  title: "Rename Administrator account"
  description: "Ensure default Administrator account is renamed"
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon"
  value_name: "DefaultUserName"
  expected_state:
    operator: "ne"
    value: "Administrator"
  remediate_type: "registry_set"
  set_value: "WinAdmin"
  set_type: "STRING"
  post_reboot_required: false
  reference: "Annexure A Page 3, Item 2.a.ii"
- id: "A.2.a.iii"
  title: "Rename Guest account"
  description: "Ensure default Guest account is renamed"
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon"
  value_name: "DefaultGuestName"
  expected_state:
    operator: "ne"
    value: "Guest"
  remediate_type: "registry_set"
  set_value: "WinGuest"
  set_type: "STRING"
  post_reboot_required: false
  missing_is_compliant: true
  missing_compliant_message: "No longer applicable in modern Windows versions where Guest account is disabled by default"
  reference: "Annexure A Page 3, Item 2.a.iii"

- id: "A.2.b.i"
  title: "Set account lockout threshold"
  description: "Ensure account lockout threshold is 5 invalid attempts or fewer"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "local_policy"
  policy_name: "LockoutBadCount"
  expected_state:
    operator: "lte"
    value: 5
  remediate_type: "local_policy_set"
  set_value: 5
  post_reboot_required: false
  reference: "Annexure A Page 3, Item 2.b.i"
- id: "A.2.b.ii"
  title: "Set account lockout duration"
  description: "Ensure account lockout duration is at least 15 minutes"
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "local_policy"
  policy_name: "LockoutDuration"
  expected_state:
    operator: "gte"
    value: 15
  remediate_type: "local_policy_set"
  set_value: 15
  post_reboot_required: false
  reference: "Annexure A Page 3, Item 2.b.ii"
- id: "A.2.b.iii"
  title: "Reset account lockout counter"
  description: "Ensure account lockout counter reset time is at least 15 minutes"
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "local_policy"
  policy_name: "ResetLockoutCount"
  expected_state:
    operator: "gte"
    value: 15
  remediate_type: "local_policy_set"
  set_value: 15
  post_reboot_required: false
  reference: "Annexure A Page 3, Item 2.b.iii"
- id: "A.2.b.iv"
  title: "Interactive logon: Do not display last user name"
  description: "Ensure the previous username is not displayed on the secure desktop"
  platform: "windows"
  severity: "medium"
  reversible: true

  # Audit intent
  check_type: "registry"

  registry:
    path: "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System"
    value_name: "DontDisplayLastUserName"
    value_type: "DWORD"

  expected_state:
    operator: "eq"
    value: 1

  # Remediation intent
  remediate_type: "registry_set"
  set_value: 1

  post_reboot_required: false
  reference: "Annexure A Page 3, Item 2.b.iv"

- id: "A.2.b.v"
  title: "Interactive logon: Message text for users attempting to log on"
  description: "Ensure a legal warning banner is displayed to users before logging on"
  platform: "windows"
  severity: "low"
  reversible: true
  check_type: "registry"
  policy_name: "LegalNoticeText"
  registry_key: "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System"
  registry_value: "legalnoticetext"
  expected_state:
    operator: "not_empty"
    value: null
  remediate_type: "registry_set"
  set_value: "Authorized Use Only. All activity is monitored."
  post_reboot_required: false
  reference: "Annexure A Page 3, Item 2.b.v"
- id: "A.2.b.vi"
  title: "Network access: Do not allow storage of passwords and credentials"
  description: "Ensure passwords and credentials are not stored for network authentication"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "registry"
  policy_name: "DisablePasswordSaving"
  registry_key: "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa"
  registry_value: "disabledomaincreds"
  expected_state:
    operator: "eq"
    value: 1
  remediate_type: "registry_set"
  set_value: 1
  post_reboot_required: true
  reference: "Annexure A Page 3, Item 2.b.vi"
- id: "A.2.b.vii"
  title: "Shutdown: Clear virtual memory pagefile"
  description: "Ensure the system clears the pagefile upon shutdown to prevent data remnant recovery"
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "registry"
  policy_name: "ClearPageFileAtShutdown"
  registry_key: "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Memory Management"
  registry_value: "ClearPageFileAtShutdown"
  expected_state:
    operator: "eq"
    value: 1
  remediate_type: "registry_set"
  set_value: 1
  post_reboot_required: true
  reference: "Annexure A Page 3, Item 2.b.vii"
- id: "A.2.c.i"
  title: "Limit local account use of blank passwords"
  description: "Ensure local accounts with blank passwords cannot be used remotely"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "local_policy"
  policy_name: "LimitBlankPasswordUse"
  expected_state: "1"
  remediate_type: "local_policy_set"
  set_value: "1"
  post_reboot_required: false
  reference: "Annexure A Page 3, Item 2.c.i"
- id: "A.2.d.i"
  title: "User Account Control: Run all administrators in Admin Approval Mode"
  description: "Ensure UAC is enabled for all users, including administrators"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "registry"
  policy_name: "EnableLUA"
  registry_key: "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System"
  registry_value: "EnableLUA"
  expected_state:
    operator: "eq"
    value: 1
  remediate_type: "registry_set"
  set_value: 1
  post_reboot_required: true
  reference: "Annexure A Page 4, Item 2.d.i"
- id: "A.2.d.ii"
  title: "User Account Control: Behavior of the elevation prompt for administrators"
  description: "Ensure the UAC prompt requests consent on the secure desktop"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "registry"
  policy_name: "ConsentPromptBehaviorAdmin"
  registry_key: "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System"
  registry_value: "ConsentPromptBehaviorAdmin"
  expected_state:
    operator: "eq"
    value: 2
  remediate_type: "registry_set"
  set_value: 2
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 2.d.ii"
- id: "A.2.d.iii"
  title: "User Account Control: Switch to the secure desktop when prompting for elevation"
  description: "Ensure the desktop is dimmed and locked (Secure Desktop) during UAC prompts"
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "registry"
  policy_name: "PromptOnSecureDesktop"
  registry_key: "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System"
  registry_value: "PromptOnSecureDesktop"
  expected_state:
    operator: "eq"
    value: 1
  remediate_type: "registry_set"
  set_value: 1
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 2.d.iii"
- id: "A.2.d.iv"
  title: "User Account Control: Detect application installations and prompt for elevation"
  description: "Ensure Windows detects installers and prompts for permissions"
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "registry"
  policy_name: "EnableInstallerDetection"
  registry_key: "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System"
  registry_value: "EnableInstallerDetection"
  expected_state:
    operator: "eq"
    value: 1
  remediate_type: "registry_set"
  set_value: 1
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 2.d.iv"
- id: "A.2.d.v"
  title: "Network security: LAN Manager authentication level"
  description: "Ensure only NTLMv2 is used (refuse LM and NTLM) to prevent credential theft"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "registry"
  policy_name: "LmCompatibilityLevel"
  registry_key: "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa"
  registry_value: "LmCompatibilityLevel"
  expected_state:
    operator: "gte"
    value: 5
  remediate_type: "registry_set"
  set_value: 5
  post_reboot_required: true
  reference: "Annexure A Page 4, Item 2.d.v"
- id: "A.2.d.vi"
  title: "Network access: Do not allow anonymous enumeration of SAM accounts"
  description: "Prevent anonymous users from listing user accounts on the system"
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "registry"
  policy_name: "RestrictAnonymousSAM"
  registry_key: "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa"
  registry_value: "RestrictAnonymousSAM"
  expected_state:
    operator: "eq"
    value: 1
  remediate_type: "registry_set"
  set_value: 1
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 2.d.vi"
- id: "A.2.d.vii"
  title: "Network access: Do not allow anonymous enumeration of SAM accounts and shares"
  description: "Prevent anonymous users from listing shares and accounts"
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "registry"
  policy_name: "RestrictAnonymous"
  registry_key: "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa"
  registry_value: "RestrictAnonymous"
  expected_state:
    operator: "eq"
    value: 1
  remediate_type: "registry_set"
  set_value: 1
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 2.d.vii"
- id: "A.2.d.viii"
  title: "Remote Desktop: Require Network Level Authentication (NLA)"
  description: "Ensure RDP connections require authentication before establishing a session"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "registry"
  policy_name: "UserAuthentication"
  registry_key: "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp"
  registry_value: "UserAuthentication"
  expected_state:
    operator: "eq"
    value: 1
  remediate_type: "registry_set"
  set_value: 1
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 2.d.viii"
- id: "A.2.c.ix"
  title: "Restore files and directories"
  description: "Ensure 'Restore files and directories' is restricted to Administrators and Backup Operators"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "user_right"
  policy_name: "SeRestorePrivilege"
  expected_state:
  operator: "equals"
  value: ["Administrators", "Backup Operators"]
  remediate_type: "user_right_set"
  set_value: ["Administrators", "Backup Operators"]
  post_reboot_required: false
  reference: "Annexure A Page 3, Item 2.c.ix"
- id: "A.2.c.x"
  title: "Shut down the system"
  description: "Ensure 'Shut down the system' is restricted to Administrators, Backup Operators, and Users"
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "user_right"
  policy_name: "SeShutdownPrivilege"
  expected_state:
    operator: "equals"
    value: ["Administrators", "Backup Operators", "Users"]
  remediate_type: "user_right_set"
  set_value: ["Administrators", "Backup Operators", "Users"]
  post_reboot_required: false
  reference: "Annexure A Page 3, Item 2.c.x"
- id: "A.2.c.xi"
  title: "Synchronize directory service data"
  description: "Ensure 'Synchronize directory service data' is set to 'No One'"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "user_right"
  policy_name: "SeSyncAgentPrivilege"
  expected_state:
    operator: "equals"
    value: []
  remediate_type: "user_right_set"
  set_value: []
  post_reboot_required: false
  reference: "Annexure A Page 3, Item 2.c.xi"
- id: "A.2.c.xii"
  title: "Take ownership of files or other objects"
  description: "Ensure 'Take ownership of files or other objects' is restricted to Administrators"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "user_right"
  policy_name: "SeTakeOwnershipPrivilege"
  expected_state:
    operator: "equals"
    value: ["Administrators"]
  remediate_type: "user_right_set"
  set_value: ["Administrators"]
  post_reboot_required: false
  reference: "Annexure A Page 3, Item 2.c.xii"
- id: "A.3.a.i"
  title: "Disable SMBv1 protocol"
  description: "Ensure SMBv1 protocol is disabled"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\Parameters"
  value_name: "SMB1"
  expected_state:
    operator: "eq"
    value: 0
  remediate_type: "registry_set"
  set_value: 0
  set_type: "DWORD"
  post_reboot_required: true
  missing_is_compliant: true
  missing_compliant_message: "SMBv1 policy key not present; SMBv1 enforced by system defaults (secure)"
  reference: "Annexure A Page 4, Item 3.a.i"
- id: "A.3.a.ii"
  title: "Enable Windows Firewall for Domain profile"
  description: "Ensure Windows Firewall is enabled for Domain profile"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile"
  value_name: "EnableFirewall"
  expected_state:
    operator: "eq"
    value: 1
  remediate_type: "registry_set"
  set_value: 1
  set_type: "DWORD"
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 3.a.ii"
- id: "A.3.a.iii"
  title: "Enable Windows Firewall for Private profile"
  description: "Ensure Windows Firewall is enabled for Private profile"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile"
  value_name: "EnableFirewall"
  expected_state:
    operator: "eq"
    value: 1
  remediate_type: "registry_set"
  set_value: 1
  set_type: "DWORD"
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 3.a.iii"
- id: "A.3.a.iv"
  title: "Enable Windows Firewall for Public profile"
  description: "Ensure Windows Firewall is enabled for Public profile"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile"
  value_name: "EnableFirewall"
  expected_state:
    operator: "eq"
    value: 1
  remediate_type: "registry_set"
  set_value: 1
  set_type: "DWORD"
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 3.a.iv"
- id: "A.3.b.i"
  title: "Configure network access to shares and pipes"
  description: "Ensure network access to named pipes and shares is restricted"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SYSTEM\\CurrentControlSet\\Services\\LanManServer\\Parameters"
  value_name: "RestrictNullSessAccess"
  expected_state:
    operator: "eq"
    value: 1
  remediate_type: "registry_set"
  set_value: 1
  set_type: "DWORD"
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 3.b.i"
- id: "A.3.b.ii"
  title: "Disable LLMNR protocol"
  description: "Ensure Link-Local Multicast Name Resolution (LLMNR) is disabled"
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\DNSClient"
  value_name: "EnableMulticast"
  expected_state:
    operator: "eq"
    value: 0
  remediate_type: "registry_set"
  set_value: 0
  set_type: "DWORD"
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 3.b.ii"
- id: "A.3.c.i"
  title: "Disable NetBIOS over TCP/IP"
  description: "Ensure NetBIOS over TCP/IP is disabled"
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SYSTEM\\CurrentControlSet\\Services\\NetBT\\Parameters"
  value_name: "NodeType"
  expected_state:
    operator: "eq"
    value: 2
  remediate_type: "registry_set"
  set_value: 2
  set_type: "DWORD"
  post_reboot_required: true
  reference: "Annexure A Page 4, Item 3.c.i"
  missing_is_compliant: true
  missing_compliant_message: "NetBIOS over TCP/IP not explicitly configured; defaults to disabled or broadcast mode (secure default)"
- id: "A.3.c.ii"
  title: "Enable DEP for all programs"
  description: "Ensure Data Execution Prevention (DEP) is enabled for all programs"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer"
  value_name: "NoDataExecutionPrevention"
  expected_state:
    operator: "eq"
    value: 0
  remediate_type: "registry_set"
  set_value: 0
  set_type: "DWORD"
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 3.c.ii"
  missing_is_compliant: true
  missing_compliant_message: "DEP policy key not present; DEP enforced by system defaults (secure)"
- id: "A.3.d.i"
  title: "Enable structured exception handling overwrite protection"
  description: "Ensure SEHOP is enabled"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\kernel"
  value_name: "DisableExceptionChainValidation"
  expected_state:
    operator: "eq"
    value: 0
  remediate_type: "registry_set"
  set_value: 0
  set_type: "DWORD"
  post_reboot_required: true
  reference: "Annexure A Page 4, Item 3.d.i"
- id: "A.3.d.ii"
  title: "Configure Windows Firewall logging"
  description: "Ensure Windows Firewall logs dropped packets for all profiles"
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging"
  value_name: "LogDroppedPackets"
  expected_state:
    operator: "eq"
    value: 1
  remediate_type: "registry_set"
  set_value: 1
  set_type: "DWORD"
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 3.d.ii"
- id: "A.3.e.i"
  title: "Force audit policy subcategory settings"
  description: "Ensure advanced audit policy settings override category-based audit policies"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa"
  value_name: "SCENoApplyLegacyAuditPolicy"
  expected_state:
    operator: "eq"
    value: 1
  remediate_type: "registry_set"
  set_value: 1
  set_type: "DWORD"
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 3.e.i"
- id: "A.3.e.ii"
  title: "Shutdown system if unable to log security audits"
  description: "Ensure the system halts when audit logs cannot be written"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa"
  value_name: "CrashOnAuditFail"
  expected_state:
    operator: "eq"
    value: 1
  remediate_type: "registry_set"
  set_value: 1
  set_type: "DWORD"
  post_reboot_required: true
  reference: "Annexure A Page 4, Item 3.e.ii"
- id: "A.3.e.iii"
  title: "DCOM Machine Access Restrictions"
  description: "Restrict DCOM access using secure SDDL configuration"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SOFTWARE\\Microsoft\\Ole"
  value_name: "MachineAccessRestriction"
  expected_state:
    operator: "eq"
    value: "<Secure_SDDL_Value>"
  remediate_type: "registry_set"
  set_value: "<Secure_SDDL_Value>"
  set_type: "STRING"
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 3.e.iii"
- id: "A.3.e.iv"
  title: "DCOM Machine Launch Restrictions"
  description: "Restrict DCOM launch permissions using secure SDDL"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SOFTWARE\\Microsoft\\Ole"
  value_name: "MachineLaunchRestriction"
  expected_state:
    operator: "eq"
    value: "<Secure_SDDL_Value>"
  remediate_type: "registry_set"
  set_value: "<Secure_SDDL_Value>"
  set_type: "STRING"
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 3.e.iv"
- id: "A.3.e.vi"
  title: "Prevent users from installing printer drivers"
  description: "Ensure standard users are blocked from installing printer drivers"
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Print\\Providers\\LanMan Print Services\\Servers"
  value_name: "AddPrinterDrivers"
  expected_state:
    operator: "eq"
    value: 1
  remediate_type: "registry_set"
  set_value: 1
  set_type: "DWORD"
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 3.e.vi"
- id: "A.3.e.vii"
  title: "Restrict CD-ROM access to locally logged-on user"
  description: "Ensure CD drives cannot be accessed remotely"
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon"
  value_name: "AllocateCDRoms"
  expected_state:
    operator: "eq"
    value: "1"
  remediate_type: "registry_set"
  set_value: "1"
  set_type: "STRING"
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 3.e.vii"
- id: "A.3.e.viii"
  title: "Allow computer account reuse during domain join"
  description: "Prevent unauthorized reuse of existing computer accounts"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "gpo"
  target_path: "Computer Configuration\\Windows Settings\\Security Settings\\Local Policies\\Security Options"
  value_name: "MACHINE_ACCOUNT_REUSE"
  expected_state:
    operator: "eq"
    value: "Disabled"
  remediate_type: "gpo_set"
  set_value: "Disabled"
  set_type: "STRING"
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 3.e.viii"
- id: "A.3.e.ix"
  title: "Block vulnerable Netlogon secure channel connections"
  description: "Ensure insecure Netlogon connections are blocked"
  platform: "windows"
  severity: "critical"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SYSTEM\\CurrentControlSet\\Services\\Netlogon\\Parameters"
  value_name: "RequireSignOrSeal"
  expected_state:
    operator: "eq"
    value: 1
  remediate_type: "registry_set"
  set_value: 1
  set_type: "DWORD"
  post_reboot_required: true
  reference: "Annexure A Page 4, Item 3.e.ix"
- id: "A.3.f.i"
  title: "LDAP server channel binding token requirements"
  description: "Enforce LDAP channel binding to mitigate man-in-the-middle and downgrade attacks."
  platform: "windows"
  severity: "critical"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SYSTEM\\CurrentControlSet\\Services\\NTDS\\Parameters"
  value_name: "LdapEnforceChannelBinding"
  expected_state:
    operator: "eq"
    value: 2
  remediate_type: "registry_set"
  set_value: 2
  set_type: "DWORD"
  post_reboot_required: true
  reference: "Annexure A Page 4, Item 3.f.i"
- id: "A.3.f.ii"
  title: "LDAP server signing requirements"
  description: "Require LDAP signing on domain controllers to protect integrity of LDAP traffic."
  platform: "windows"
  severity: "critical"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SYSTEM\\CurrentControlSet\\Services\\NTDS\\Parameters"
  value_name: "LDAPServerIntegrity"
  expected_state:
    operator: "eq"
    value: 2
  remediate_type: "registry_set"
  set_value: 2
  set_type: "DWORD"
  post_reboot_required: true
  reference: "Annexure A Page 4, Item 3.f.ii"
- id: "A.3.f.iii"
  title: "Digitally encrypt or sign secure channel data (always)"
  description: "Ensure secure channel data is always encrypted or signed to protect confidentiality and integrity."
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "gpo"
  target_path: "Computer Configuration\\Windows Settings\\Security Settings\\Local Policies\\Security Options"
  value_name: "SecureChannel_EncryptOrSignAlways"
  expected_state:
    operator: "eq"
    value: "Enabled"
  remediate_type: "gpo_set"
  set_value: "Enabled"
  set_type: "STRING"
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 3.f.iii"
- id: "A.3.f.iv"
  title: "Refuse machine account password changes"
  description: "Prevent unauthorized attempts to change domain machine account passwords (protects trust relationships)."
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SYSTEM\\CurrentControlSet\\Services\\Netlogon\\Parameters"
  value_name: "RefusePasswordChange"
  expected_state:
    operator: "eq"
    value: 1
  remediate_type: "registry_set"
  set_value: 1
  set_type: "DWORD"
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 3.f.iv"
- id: "A.3.f.v"
  title: "Maximum machine account password age"
  description: "Limit lifetime of machine account passwords to force regular rotation and limit exposure."
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SYSTEM\\CurrentControlSet\\Services\\Netlogon\\Parameters"
  value_name: "MaximumPasswordAge"
  expected_state:
    operator: "lte"
    value: 30
  remediate_type: "registry_set"
  set_value: 30
  set_type: "DWORD"
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 3.f.v"
- id: "A.3.f.vi"
  title: "Require strong Windows session key"
  description: "Enforce strong (Windows 2000 or later) session keys for domain secure channels."
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "gpo"
  target_path: "Computer Configuration\\Windows Settings\\Security Settings\\Local Policies\\Security Options"
  value_name: "StrongSessionKeyRequired"
  expected_state:
    operator: "eq"
    value: "Enabled"
  remediate_type: "gpo_set"
  set_value: "Enabled"
  set_type: "STRING"
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 3.f.vi"
- id: "A.3.g.i"
  title: "Interactive logon: Do not require CTRL+ALT+DEL"
  description: "Require users to press CTRL+ALT+DEL at interactive logon to mitigate credential-capture attacks."
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "gpo"
  target_path: "Computer Configuration\\Windows Settings\\Security Settings\\Local Policies\\Security Options"
  value_name: "DisableCAD"
  expected_state:
    operator: "eq"
    value: 0
  remediate_type: "gpo_set"
  set_value: 0
  set_type: "DWORD"
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 3.g.i"
- id: "A.3.g.ii"
  title: "Interactive logon: Don't display last signed-in"
  description: "Prevent display of the last interactive logon account to reduce targeted-account disclosure."
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "gpo"
  target_path: "Computer Configuration\\Windows Settings\\Security Settings\\Local Policies\\Security Options"
  value_name: "InteractiveLogon_DontDisplayLastSignedIn"
  expected_state:
    operator: "eq"
    value: "Enabled"
  remediate_type: "gpo_set"
  set_value: "Enabled"
  set_type: "STRING"
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 3.g.ii"
- id: "A.3.g.iii"
  title: "Interactive logon: Don't display username at sign-in"
  description: "Do not pre-fill or display the username on the sign-in screen to reduce account enumeration and exposure."
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "gpo"
  target_path: "Computer Configuration\\Windows Settings\\Security Settings\\Local Policies\\Security Options"
  value_name: "InteractiveLogon_DontDisplayUsername"
  expected_state:
    operator: "eq"
    value: "Enabled"
  remediate_type: "gpo_set"
  set_value: "Enabled"
  set_type: "STRING"
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 3.g.iii"
- id: "A.3.g.iv"
  title: "Interactive logon: Display user information when the session is locked"
  description: "Do not display user details on the lock screen to avoid information disclosure and social engineering vectors."
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "gpo"
  target_path: "Computer Configuration\\Windows Settings\\Security Settings\\Local Policies\\Security Options"
  value_name: "InteractiveLogon_DisplayUserInfoWhenLocked"
  expected_state:
    operator: "eq"
    value: "Do not display user information"
  remediate_type: "gpo_set"
  set_value: "Do not display user information"
  set_type: "STRING"
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 3.g.iv"
- id: "A.3.g.v"
  title: "Interactive logon: Machine inactivity limit"
  description: "Automatically lock sessions after a short idle period to reduce risk of an unattended workstation being used."
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "gpo"
  target_path: "Computer Configuration\\Windows Settings\\Security Settings\\Local Policies\\Security Options"
  value_name: "InteractiveLogon_MachineInactivityLimit"
  expected_state:
    operator: "lte"
    value: 300
  remediate_type: "gpo_set"
  set_value: 300
  set_type: "DWORD"
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 3.g.v"
- id: "A.3.g.vi"
  title: "Interactive logon: Number of previous logons to cache (in case domain controller is not available)"
  description: "Reduce cached credentials to limit credential exposure when offline; setting to 0 disables cached logons."
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "gpo"
  target_path: "Computer Configuration\\Windows Settings\\Security Settings\\Local Policies\\Security Options"
  value_name: "InteractiveLogon_NumPreviousLogonsToCache"
  expected_state:
    operator: "eq"
    value: 0
  remediate_type: "gpo_set"
  set_value: 0
  set_type: "DWORD"
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 3.g.vi"
- id: "A.3.g.vii"
  title: "Interactive logon: Prompt user to change password before expiration"
  description: "Warn users ahead of password expiry to avoid emergency password resets and possible insecure workarounds."
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "gpo"
  target_path: "User Configuration\\Administrative Templates\\Windows Components\\Windows Logon Options"
  value_name: "ChangePasswordPromptDays"
  expected_state:
    operator: "gte"
    value: 14
  remediate_type: "gpo_set"
  set_value: 14
  set_type: "DWORD"
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 3.g.vii"
- id: "A.3.g.viii"
  title: "Interactive logon: Require Domain Controller authentication to unlock workstation"
  description: "Require DC authentication for unlock to ensure centralized policy and credential checks are enforced."
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "gpo"
  target_path: "Computer Configuration\\Windows Settings\\Security Settings\\Local Policies\\Security Options"
  value_name: "InteractiveLogon_RequireDCAuthToUnlock"
  expected_state:
    operator: "eq"
    value: "Enabled"
  remediate_type: "gpo_set"
  set_value: "Enabled"
  set_type: "STRING"
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 3.g.viii"
- id: "A.3.g.ix"
  title: "Interactive logon: Require Windows Hello for Business or smart card"
  description: "Enforce a strong multi-factor credential (Windows Hello for Business or smart card) for interactive logon where feasible."
  platform: "windows"
  severity: "critical"
  reversible: true
  check_type: "gpo"
  target_path: "Computer Configuration\\Administrative Templates\\Windows Components\\Windows Hello for Business"
  value_name: "UseWinHelloForBusiness"
  expected_state:
    operator: "eq"
    value: "Enabled"
  remediate_type: "gpo_set"
  set_value: "Enabled"
  set_type: "STRING"
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 3.g.ix"
- id: "A.3.g.x"
  title: "Interactive logon: Smart card removal behavior"
  description: "Automatically lock the workstation when the smart card is removed to protect active sessions."
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "gpo"
  target_path: "Computer Configuration\\Windows Settings\\Security Settings\\Local Policies\\Security Options"
  value_name: "SmartCardRemovalBehavior"
  expected_state:
    operator: "eq"
    value: "Lock Workstation"
  remediate_type: "gpo_set"
  set_value: "Lock Workstation"
  set_type: "STRING"
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 3.g.x"
- id: "A.3.h.i"
  title: "Microsoft network client: Digitally sign communications (always)"
  description: "Ensure all SMB client communications are digitally signed to protect against relay and tampering attacks."
  platform: "windows"
  severity: "critical"
  reversible: true
  check_type: "gpo"
  target_path: "Computer Configuration\\Windows Settings\\Security Settings\\Local Policies\\Security Options"
  value_name: "MicrosoftNetworkClient_SignAlways"
  expected_state:
    operator: "eq"
    value: "Enabled"
  remediate_type: "gpo_set"
  set_value: "Enabled"
  set_type: "STRING"
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 3.h.i"
- id: "A.3.h.ii"
  title: "Microsoft network client: Send unencrypted password to third-party SMB servers"
  description: "Prevent clients from sending clear-text passwords to SMB servers to avoid credential exposure."
  platform: "windows"
  severity: "critical"
  reversible: true
  check_type: "gpo"
  target_path: "Computer Configuration\\Windows Settings\\Security Settings\\Local Policies\\Security Options"
  value_name: "MicrosoftNetworkClient_SendUnencryptedPassword"
  expected_state:
    operator: "eq"
    value: "Disabled"
  remediate_type: "gpo_set"
  set_value: "Disabled"
  set_type: "STRING"
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 3.h.ii"
- id: "A.3.h.iii"
  title: "Microsoft network server: Digitally sign communications (always)"
  description: "Require SMB servers to sign all communications to mitigate man-in-the-middle and SMB spoofing attacks."
  platform: "windows"
  severity: "critical"
  reversible: true
  check_type: "gpo"
  target_path: "Computer Configuration\\Windows Settings\\Security Settings\\Local Policies\\Security Options"
  value_name: "MicrosoftNetworkServer_SignAlways"
  expected_state:
    operator: "eq"
    value: "Enabled"
  remediate_type: "gpo_set"
  set_value: "Enabled"
  set_type: "STRING"
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 3.h.iii"
- id: "A.3.h.iv"
  title: "Microsoft network server: Disconnect clients when logon hours expire"
  description: "Enforce logon-hours restrictions by disconnecting SMB clients when allowed login window ends."
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "gpo"
  target_path: "Computer Configuration\\Windows Settings\\Security Settings\\Local Policies\\Security Options"
  value_name: "MicrosoftNetworkServer_DisconnectWhenLogonHoursExpire"
  expected_state:
    operator: "eq"
    value: "Enabled"
  remediate_type: "gpo_set"
  set_value: "Enabled"
  set_type: "STRING"
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 3.h.iv"
- id: "A.3.h.v"
  title: "Microsoft network server: Server SPN target name validation level"
  description: "Enable SPN validation to prevent SMB replay, pass-the-hash, and credential relay attacks."
  platform: "windows"
  severity: "critical"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\Parameters"
  value_name: "SmbServerNameHardeningLevel"
  expected_state:
    operator: "eq"
    value: 1
  remediate_type: "registry_set"
  set_value: 1
  set_type: "DWORD"
  post_reboot_required: true
  reference: "Annexure A Page 4, Item 3.h.v"
- id: "A.3.h.vi"
  title: "Network access: Allow anonymous SID/Name translation"
  description: "Disable anonymous SID/Name translation to prevent attackers from mapping accounts without authentication."
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "gpo"
  target_path: "Computer Configuration\\Windows Settings\\Security Settings\\Local Policies\\Security Options"
  value_name: "NetworkAccess_AllowAnonymousSIDNameTranslation"
  expected_state:
    operator: "eq"
    value: "Disabled"
  remediate_type: "gpo_set"
  set_value: "Disabled"
  set_type: "STRING"
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 3.h.vi"
- id: "A.3.h.vii"
  title: "Network access: Do not allow anonymous enumeration of SAM accounts"
  description: "Prevent anonymous enumeration of SAM accounts to block reconnaissance and account-discovery attacks."
  platform: "windows"
  severity: "critical"
  reversible: true
  check_type: "gpo"
  target_path: "Computer Configuration\\Windows Settings\\Security Settings\\Local Policies\\Security Options"
  value_name: "NetworkAccess_DoNotAllowAnonymousEnumerationSAM"
  expected_state:
    operator: "eq"
    value: "Enabled"
  remediate_type: "gpo_set"
  set_value: "Enabled"
  set_type: "STRING"
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 3.h.vii"
- id: "A.3.i.i"
  title: "Network access: Do not allow anonymous enumeration of SAM accounts and shares"
  description: "Prevents anonymous users from enumerating SAM accounts or shared resources, blocking reconnaissance attacks."
  platform: "windows"
  severity: "critical"
  reversible: true
  check_type: "gpo"
  target_path: "Computer Configuration\\Windows Settings\\Security Settings\\Local Policies\\Security Options"
  value_name: "NetworkAccess_DenyAnonymousSAMAndShares"
  expected_state:
    operator: "eq"
    value: "Enabled"
  remediate_type: "gpo_set"
  set_value: "Enabled"
  set_type: "STRING"
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 3.i.i"
- id: "A.3.i.ii"
  title: "Network access: Do not allow storage of passwords and credentials for network authentication"
  description: "Ensures Windows does not store plaintext or reversible credentials, preventing credential harvesting attacks."
  platform: "windows"
  severity: "critical"
  reversible: true
  check_type: "gpo"
  target_path: "Computer Configuration\\Windows Settings\\Security Settings\\Local Policies\\Security Options"
  value_name: "NetworkAccess_NoCredentialStorage"
  expected_state:
    operator: "eq"
    value: "Enabled"
  remediate_type: "gpo_set"
  set_value: "Enabled"
  set_type: "STRING"
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 3.i.ii"
- id: "A.3.i.iii"
  title: "Network security: LAN Manager authentication level"
  description: "Require NTLMv2 responses only; prevents legacy LM/NTLM protocols from being used in authentication attacks."
  platform: "windows"
  severity: "critical"
  reversible: true
  check_type: "gpo"
  target_path: "Computer Configuration\\Windows Settings\\Security Settings\\Local Policies\\Security Options"
  value_name: "NetworkSecurity_LMAuthLevel"
  expected_state:
    operator: "eq"
    value: "Send NTLMv2 response only"
  remediate_type: "gpo_set"
  set_value: "Send NTLMv2 response only"
  set_type: "STRING"
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 3.i.iii"
- id: "A.3.i.iv"
  title: "Network security: Restrict NTLM â€” NTLM authentication in this domain"
  description: "Restricts or disables NTLM authentication to prevent pass-the-hash, relay, and downgrade attacks."
  platform: "windows"
  severity: "critical"
  reversible: true
  check_type: "gpo"
  target_path: "Computer Configuration\\Windows Settings\\Security Settings\\Local Policies\\Security Options"
  value_name: "NetworkSecurity_RestrictNTLM_Domain"
  expected_state:
    operator: "eq"
    value: "Deny all"
  remediate_type: "gpo_set"
  set_value: "Deny all"
  set_type: "STRING"
  post_reboot_required: true
  reference: "Annexure A Page 4, Item 3.i.iv"
- id: "A.3.i.v"
  title: "Network security: Minimum session security for NTLM SSP based clients"
  description: "Enforces strong NTLM session security for client-side communications, preventing downgrade and replay attacks."
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\MSV1_0"
  value_name: "NTLMMinClientSec"
  expected_state:
    operator: "eq"
    value: 0x20080000
  remediate_type: "registry_set"
  set_value: 0x20080000
  set_type: "DWORD"
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 3.i.v"
- id: "A.3.i.vi"
  title: "Network security: Minimum session security for NTLM SSP based servers"
  description: "Ensures servers require strong NTLM protections, enabling packet signing and encryption."
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\MSV1_0"
  value_name: "NTLMMinServerSec"
  expected_state:
    operator: "eq"
    value: 0x20080000
  remediate_type: "registry_set"
  set_value: 0x20080000
  set_type: "DWORD"
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 3.i.vi"
- id: "A.3.i.vii"
  title: "Network security: Configure encryption types allowed for Kerberos"
  description: "Restrict Kerberos to strong encryption types only (AES128/AES256) to prevent downgrade or RC4-based attacks."
  platform: "windows"
  severity: "critical"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\Kerberos\\Parameters"
  value_name: "SupportedEncryptionTypes"
  expected_state:
    operator: "eq"
    value: 0x18
  remediate_type: "registry_set"
  set_value: 0x18
  set_type: "DWORD"
  post_reboot_required: true
  reference: "Annexure A Page 4, Item 3.i.vii"
- id: "A.3.j.i"
  title: "Network security: Restrict NTLM: Outgoing NTLM traffic to remote servers"
  description: "Prevent Windows from using NTLM when authenticating to remote servers, mitigating pass-the-hash and NTLM relay attacks."
  platform: "windows"
  severity: "critical"
  reversible: true
  check_type: "gpo"
  target_path: "Computer Configuration\\Windows Settings\\Security Settings\\Local Policies\\Security Options"
  value_name: "NetworkSecurity_RestrictNTLM_Outbound"
  expected_state:
    operator: "eq"
    value: "Deny all"
  remediate_type: "gpo_set"
  set_value: "Deny all"
  set_type: "STRING"
  post_reboot_required: true
  reference: "Annexure A Page 4, Item 3.j.i"
- id: "A.3.j.ii"
  title: "Recovery console: Allow automatic administrative logon"
  description: "Disable automatic admin logon in Recovery Console to prevent unauthorized full-system access."
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "gpo"
  target_path: "Computer Configuration\\Windows Settings\\Security Settings\\Local Policies\\Security Options"
  value_name: "RecoveryConsole_AllowAutoAdminLogon"
  expected_state:
    operator: "eq"
    value: "Disabled"
  remediate_type: "gpo_set"
  set_value: "Disabled"
  set_type: "STRING"
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 3.j.ii"
- id: "A.3.j.iii"
  title: "Recovery console: Allow floppy copy and access to all drives and folders"
  description: "Prevent full unrestricted disk access from the recovery console, which could lead to data exfiltration or manipulation."
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "gpo"
  target_path: "Computer Configuration\\Windows Settings\\Security Settings\\Local Policies\\Security Options"
  value_name: "RecoveryConsole_AllowAllAccess"
  expected_state:
    operator: "eq"
    value: "Disabled"
  remediate_type: "gpo_set"
  set_value: "Disabled"
  set_type: "STRING"
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 3.j.iii"
- id: "A.3.j.iv"
  title: "Shutdown: Clear virtual memory pagefile"
  description: "Clear the pagefile on shutdown to prevent recovery of sensitive data from disk."
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Memory Management"
  value_name: "ClearPageFileAtShutdown"
  expected_state:
    operator: "eq"
    value: 1
  remediate_type: "registry_set"
  set_value: 1
  set_type: "DWORD"
  post_reboot_required: true
  reference: "Annexure A Page 4, Item 3.j.iv"
- id: "A.3.j.v"
  title: "System cryptography: Force strong key protection"
  description: "Require strong cryptographic key protection for private keys stored on the system."
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\Cryptography"
  value_name: "ForceKeyProtection"
  expected_state:
    operator: "eq"
    value: 2
  remediate_type: "registry_set"
  set_value: 2
  set_type: "DWORD"
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 3.j.v"
- id: "A.3.j.vi"
  title: "System cryptography: Use FIPS-compliant algorithms"
  description: "Enable the use of FIPS 140-2 compliant algorithms for encryption, hashing, and signing operations."
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "gpo"
  target_path: "Computer Configuration\\Windows Settings\\Security Settings\\Local Policies\\Security Options"
  value_name: "SystemCryptography_UseFIPS"
  expected_state:
    operator: "eq"
    value: "Enabled"
  remediate_type: "gpo_set"
  set_value: "Enabled"
  set_type: "STRING"
  post_reboot_required: true
  reference: "Annexure A Page 4, Item 3.j.vi"
- id: "A.3.j.vii"
  title: "System objects: Strengthen default permissions of internal system objects"
  description: "Ensures strong default ACLs on internal objects such as symbolic links to prevent privilege escalation."
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "gpo"
  target_path: "Computer Configuration\\Windows Settings\\Security Settings\\Local Policies\\Security Options"
  value_name: "SystemObjects_StrengthenDefaultPermissions"
  expected_state:
    operator: "eq"
    value: "Enabled"
  remediate_type: "gpo_set"
  set_value: "Enabled"
  set_type: "STRING"
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 3.j.vii"
- id: "A.3.k.i"
  title: "User Account Control: Admin Approval Mode for the Built-in Administrator account"
  description: "Enable Admin Approval Mode for the built-in Administrator account to prevent automatic elevation."
  platform: "windows"
  severity: "critical"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System"
  value_name: "FilterAdministratorToken"
  expected_state:
    operator: "eq"
    value: 1
  remediate_type: "registry_set"
  set_value: 1
  set_type: "DWORD"
  post_reboot_required: true
  reference: "Annexure A Page 4, Item 3.k.i"
- id: "A.3.k.ii"
  title: "User Account Control: Behavior of the elevation prompt for administrators in Admin Approval Mode"
  description: "Require consent on the secure desktop for admin elevation to mitigate spoofing and elevation attacks."
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System"
  value_name: "ConsentPromptBehaviorAdmin"
  expected_state:
    operator: "eq"
    value: 2
  remediate_type: "registry_set"
  set_value: 2
  set_type: "DWORD"
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 3.k.ii"
- id: "A.3.k.iii"
  title: "User Account Control: Behavior of the elevation prompt for standard users"
  description: "Require credentials for elevation when a standard user attempts an administrative task."
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System"
  value_name: "ConsentPromptBehaviorUser"
  expected_state:
    operator: "eq"
    value: 1
  remediate_type: "registry_set"
  set_value: 1
  set_type: "DWORD"
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 3.k.iii"
- id: "A.3.k.iv"
  title: "User Account Control: Only elevate executables that are signed and validated"
  description: "Require digital signatures for elevated applications to prevent malicious unsigned code from gaining admin access."
  platform: "windows"
  severity: "critical"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System"
  value_name: "ValidateAdminCodeSignatures"
  expected_state:
    operator: "eq"
    value: 1
  remediate_type: "registry_set"
  set_value: 1
  set_type: "DWORD"
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 3.k.iv"
- id: "A.3.k.v"
  title: "User Account Control: Only elevate UIAccess applications installed in secure locations"
  description: "Restricts elevation of UIAccess apps unless installed in secure paths to prevent GUI-based privilege escalation."
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System"
  value_name: "EnableSecureUIAPaths"
  expected_state:
    operator: "eq"
    value: 1
  remediate_type: "registry_set"
  set_value: 1
  set_type: "DWORD"
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 3.k.v"
- id: "A.3.k.vi"
  title: "User Account Control: Switch to the secure desktop when prompting for elevation"
  description: "Use a separate secure desktop for elevation prompts to mitigate spoofing and shatter attacks."
  platform: "windows"
  severity: "critical"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System"
  value_name: "PromptOnSecureDesktop"
  expected_state:
    operator: "eq"
    value: 1
  remediate_type: "registry_set"
  set_value: 1
  set_type: "DWORD"
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 3.k.vi"
- id: "A.3.k.vii"
  title: "User Account Control: Detect application installations and prompt for elevation"
  description: "Detect installers requiring admin access and request elevation, preventing silent privilege escalation."
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System"
  value_name: "EnableInstallerDetection"
  expected_state:
    operator: "eq"
    value: 1
  remediate_type: "registry_set"
  set_value: 1
  set_type: "DWORD"
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 3.k.vii"
- id: "A.4.a.i"
  title: "Enable UAC Admin Approval Mode for Built-in Administrator"
  description: "Ensure User Account Control: Admin Approval Mode for the Built-in Administrator account is enabled"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "local_policy"
  policy_name: "FilterAdministratorToken"
  expected_state: "1"
  remediate_type: "local_policy_set"
  set_value: "1"
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 4.a.i"
- id: "A.4.a.ii"
  title: "Configure UAC elevation prompt for administrators"
  description: "Ensure User Account Control: Behaviour of the elevation prompt for administrators in Admin Approval Mode is set to Prompt for consent on the secure desktop or higher"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "local_policy"
  policy_name: "ConsentPromptBehaviorAdmin"
  expected_state:
    operator: "gte"
    value: 2
  remediate_type: "local_policy_set"
  set_value: 2
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 4.a.ii"
- id: "A.4.a.iii"
  title: "Configure UAC elevation prompt for standard users"
  description: "Ensure User Account Control: Behaviour of the elevation prompt for standard users is set to Automatically deny elevation requests"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "local_policy"
  policy_name: "ConsentPromptBehaviorUser"
  expected_state: "0"
  remediate_type: "local_policy_set"
  set_value: "0"
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 4.a.iii"
- id: "A.4.a.iv"
  title: "Enable UAC application installation detection"
  description: "Ensure User Account Control: Detect application installations and prompt for elevation is enabled"
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "local_policy"
  policy_name: "EnableInstallerDetection"
  expected_state: "1"
  remediate_type: "local_policy_set"
  set_value: "1"
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 4.a.iv"
- id: "A.4.a.v"
  title: "Enable UAC Admin Approval Mode"
  description: "Ensure User Account Control: Run all administrators in Admin Approval Mode is enabled"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "local_policy"
  policy_name: "EnableLUA"
  expected_state: "1"
  remediate_type: "local_policy_set"
  set_value: "1"
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 4.a.v"
- id: "A.4.a.vi"
  title: "Enable UAC secure desktop prompt"
  description: "Ensure User Account Control: Switch to the secure desktop when prompting for elevation is enabled"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "local_policy"
  policy_name: "PromptOnSecureDesktop"
  expected_state: "1"
  remediate_type: "local_policy_set"
  set_value: "1"
  post_reboot_required: false
  reference: "Annexure A Page 4, Item 4.a.vi"
- id: "A.4.b.i"
  title: "Disable Bluetooth Audio Gateway Service"
  description: "Ensure Bluetooth Audio Gateway Service (BTAGService) is disabled"
  platform: "windows"
  severity: "low"
  reversible: true
  check_type: "service_status"
  service_name: "BTAGService"
  expected_state: "stopped_disabled"
  remediate_type: "service_disable"
  remediate_params:
    stop: true
    disable: true
  post_reboot_required: false
  reference: "Annexure A Page 5, Item 4.b.i"
- id: "A.4.b.ii"
  title: "Disable Bluetooth Support Service"
  description: "Ensure Bluetooth Support Service (bthserv) is disabled"
  platform: "windows"
  severity: "low"
  reversible: true
  check_type: "service_status"
  service_name: "bthserv"
  expected_state: "stopped_disabled"
  remediate_type: "service_disable"
  remediate_params:
    stop: true
    disable: true
  post_reboot_required: false
  reference: "Annexure A Page 5, Item 4.b.ii"
- id: "A.4.b.iii"
  title: "Disable Computer Browser service"
  description: "Ensure Computer Browser (Browser) is disabled or not installed"
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "service_status"
  service_name: "Browser"
  expected_state: "stopped_disabled"
  remediate_type: "service_disable"
  remediate_params:
    stop: true
    disable: true
  post_reboot_required: false
  reference: "Annexure A Page 5, Item 4.b.iii"
- id: "A.4.b.iv"
  title: "Disable Geolocation Service"
  description: "Ensure Geolocation Service (lfsvc) is disabled"
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "service_status"
  service_name: "lfsvc"
  expected_state: "stopped_disabled"
  remediate_type: "service_disable"
  remediate_params:
    stop: true
    disable: true
  post_reboot_required: false
  reference: "Annexure A Page 5, Item 4.b.iv"
- id: "A.4.b.v"
  title: "Disable Internet Connection Sharing"
  description: "Ensure Internet Connection Sharing (ICS) (SharedAccess) is disabled"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "service_status"
  service_name: "SharedAccess"
  expected_state: "stopped_disabled"
  remediate_type: "service_disable"
  remediate_params:
    stop: true
    disable: true
  post_reboot_required: false
  reference: "Annexure A Page 5, Item 4.b.v"
- id: "A.4.b.vi"
  title: "Disable Remote Desktop Configuration service"
  description: "Ensure Remote Desktop Configuration (SessionEnv) is disabled"
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "service_status"
  service_name: "SessionEnv"
  expected_state: "stopped_disabled"
  remediate_type: "service_disable"
  remediate_params:
    stop: true
    disable: true
  post_reboot_required: false
  reference: "Annexure A Page 5, Item 4.b.vi"
- id: "A.4.b.vii"
  title: "Disable Remote Desktop Services"
  description: "Ensure Remote Desktop Services (TermService) is disabled"
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "service_status"
  service_name: "TermService"
  expected_state: "stopped_disabled"
  remediate_type: "service_disable"
  remediate_params:
    stop: true
    disable: true
  post_reboot_required: false
  reference: "Annexure A Page 5, Item 4.b.vii"
- id: "A.4.b.viii"
  title: "Disable Remote Desktop Services UserMode Port Redirector"
  description: "Ensure Remote Desktop Services UserMode Port Redirector (UmRdpService) is disabled"
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "service_status"
  service_name: "UmRdpService"
  expected_state: "stopped_disabled"
  remediate_type: "service_disable"
  remediate_params:
    stop: true
    disable: true
  post_reboot_required: false
  reference: "Annexure A Page 5, Item 4.b.viii"
- id: "A.4.b.ix"
  title: "Disable RPC Locator service"
  description: "Ensure Remote Procedure Call (RPC) Locator (RpcLocator) is disabled"
  platform: "windows"
  severity: "low"
  reversible: true
  check_type: "service_status"
  service_name: "RpcLocator"
  expected_state: "stopped_disabled"
  remediate_type: "service_disable"
  remediate_params:
    stop: true
    disable: true
  post_reboot_required: false
  reference: "Annexure A Page 5, Item 4.b.ix"
- id: "A.4.b.x"
  title: "Disable Remote Registry service"
  description: "Ensure Remote Registry (RemoteRegistry) is disabled"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "service_status"
  service_name: "RemoteRegistry"
  expected_state: "stopped_disabled"
  remediate_type: "service_disable"
  remediate_params:
    stop: true
    disable: true
  post_reboot_required: false
  reference: "Annexure A Page 5, Item 4.b.x"
- id: "A.4.b.xi"
  title: "Disable Routing and Remote Access service"
  description: "Ensure Routing and Remote Access (RemoteAccess) is disabled"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "service_status"
  service_name: "RemoteAccess"
  expected_state: "stopped_disabled"
  remediate_type: "service_disable"
  remediate_params:
    stop: true
    disable: true
  post_reboot_required: false
  reference: "Annexure A Page 5, Item 4.b.xi"
- id: "A.4.b.xii"
  title: "Disable Simple TCP/IP Services"
  description: "Ensure Simple TCP/IP Services (simptcp) is disabled or not installed"
  platform: "windows"
  severity: "low"
  reversible: true
  check_type: "service_status"
  service_name: "simptcp"
  expected_state: "stopped_disabled"
  remediate_type: "service_disable"
  remediate_params:
    stop: true
    disable: true
  post_reboot_required: false
  reference: "Annexure A Page 5, Item 4.b.xii"
- id: "A.4.b.xiii"
  title: "Disable SNMP Service"
  description: "Ensure SNMP Service (SNMP) is disabled or not installed"
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "service_status"
  service_name: "SNMP"
  expected_state: "stopped_disabled"
  remediate_type: "service_disable"
  remediate_params:
    stop: true
    disable: true
  post_reboot_required: false
  reference: "Annexure A Page 5, Item 4.b.xiii"
- id: "A.4.b.xiv"
  title: "Disable UPnP Device Host service"
  description: "Ensure UPnP Device Host (upnphost) is disabled"
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "service_status"
  service_name: "upnphost"
  expected_state: "stopped_disabled"
  remediate_type: "service_disable"
  remediate_params:
    stop: true
    disable: true
  post_reboot_required: false
  reference: "Annexure A Page 5, Item 4.b.xiv"
- id: "A.4.b.xv"
  title: "Disable Web Management Service"
  description: "Ensure Web Management Service (WMSvc) is disabled or not installed"
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "service_status"
  service_name: "WMSvc"
  expected_state: "stopped_disabled"
  remediate_type: "service_disable"
  remediate_params:
    stop: true
    disable: true
  post_reboot_required: false
  reference: "Annexure A Page 5, Item 4.b.xv"
- id: "A.4.b.xvi"
  title: "Disable Windows Error Reporting Service"
  description: "Ensure Windows Error Reporting Service (WerSvc) is disabled"
  platform: "windows"
  severity: "low"
  reversible: true
  check_type: "service_status"
  service_name: "WerSvc"
  expected_state: "stopped_disabled"
  remediate_type: "service_disable"
  remediate_params:
    stop: true
    disable: true
  post_reboot_required: false
  reference: "Annexure A Page 5, Item 4.b.xvi"
- id: "A.4.b.xvii"
  title: "Disable Windows Event Collector service"
  description: "Ensure Windows Event Collector (Wecsvc) is disabled"
  platform: "windows"
  severity: "low"
  reversible: true
  check_type: "service_status"
  service_name: "Wecsvc"
  expected_state: "stopped_disabled"
  remediate_type: "service_disable"
  remediate_params:
    stop: true
    disable: true
  post_reboot_required: false
  reference: "Annexure A Page 5, Item 4.b.xvii"
- id: "A.4.b.xviii"
  title: "Disable Windows Media Player Network Sharing Service"
  description: "Ensure Windows Media Player Network Sharing Service (WMPNetworkSvc) is disabled or not installed"
  platform: "windows"
  severity: "low"
  reversible: true
  check_type: "service_status"
  service_name: "WMPNetworkSvc"
  expected_state: "stopped_disabled"
  remediate_type: "service_disable"
  remediate_params:
    stop: true
    disable: true
  post_reboot_required: false
  reference: "Annexure A Page 5, Item 4.b.xviii"
- id: "A.4.b.xix"
  title: "Disable Windows Mobile Hotspot Service"
  description: "Ensure Windows Mobile Hotspot Service (icssvc) is disabled"
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "service_status"
  service_name: "icssvc"
  expected_state: "stopped_disabled"
  remediate_type: "service_disable"
  remediate_params:
    stop: true
    disable: true
  post_reboot_required: false
  reference: "Annexure A Page 5, Item 4.b.xix"
- id: "A.4.b.xx"
  title: "Disable Windows PushToInstall Service"
  description: "Ensure Windows PushToInstall Service (PushToInstall) is disabled"
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "service_status"
  service_name: "PushToInstall"
  expected_state: "stopped_disabled"
  remediate_type: "service_disable"
  remediate_params:
    stop: true
    disable: true
  post_reboot_required: false
  reference: "Annexure A Page 5, Item 4.b.xx"
- id: "A.4.b.xxi"
  title: "Disable Windows Remote Management service"
  description: "Ensure Windows Remote Management (WS-Management) (WinRM) is disabled"
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "service_status"
  service_name: "WinRM"
  expected_state: "stopped_disabled"
  remediate_type: "service_disable"
  remediate_params:
    stop: true
    disable: true
  post_reboot_required: false
  reference: "Annexure A Page 5, Item 4.b.xxi"
- id: "A.4.b.xxii"
  title: "Disable World Wide Web Publishing Service"
  description: "Ensure World Wide Web Publishing Service (W3SVC) is disabled or not installed"
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "service_status"
  service_name: "W3SVC"
  expected_state: "stopped_disabled"
  remediate_type: "service_disable"
  remediate_params:
    stop: true
    disable: true
  post_reboot_required: false
  reference: "Annexure A Page 5, Item 4.b.xxii"
- id: "A.4.b.xxiii"
  title: "Disable Xbox Accessory Management Service"
  description: "Ensure Xbox Accessory Management Service (XboxGipSvc) is disabled"
  platform: "windows"
  severity: "low"
  reversible: true
  check_type: "service_status"
  service_name: "XboxGipSvc"
  expected_state: "stopped_disabled"
  remediate_type: "service_disable"
  remediate_params:
    stop: true
    disable: true
  post_reboot_required: false
  reference: "Annexure A Page 5, Item 4.b.xxiii"
- id: "A.4.b.xxiv"
  title: "Disable Xbox Live Auth Manager service"
  description: "Ensure Xbox Live Auth Manager (XblAuthManager) is disabled"
  platform: "windows"
  severity: "low"
  reversible: true
  check_type: "service_status"
  service_name: "XblAuthManager"
  expected_state: "stopped_disabled"
  remediate_type: "service_disable"
  remediate_params:
    stop: true
    disable: true
  post_reboot_required: false
  reference: "Annexure A Page 5, Item 4.b.xxiv"
- id: "A.4.b.xxv"
  title: "Disable Xbox Live Game Save service"
  description: "Ensure Xbox Live Game Save (XblGameSave) is disabled"
  platform: "windows"
  severity: "low"
  reversible: true
  check_type: "service_status"
  service_name: "XblGameSave"
  expected_state: "stopped_disabled"
  remediate_type: "service_disable"
  remediate_params:
    stop: true
    disable: true
  post_reboot_required: false
  reference: "Annexure A Page 5, Item 4.b.xxv"
- id: "A.4.b.xxvi"
  title: "Disable Xbox Live Networking Service"
  description: "Ensure Xbox Live Networking Service (XboxNetApiSvc) is disabled"
  platform: "windows"
  severity: "low"
  reversible: true
  check_type: "service_status"
  service_name: "XboxNetApiSvc"
  expected_state: "stopped_disabled"
  remediate_type: "service_disable"
  remediate_params:
    stop: true
    disable: true
  post_reboot_required: false
  reference: "Annexure A Page 5, Item 4.b.xxvi"
- id: "A.5.a.i"
  title: "Enable Windows Firewall for Private profile"
  description: "Ensure Windows Firewall: Private: Firewall state is set to On (recommended)"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile"
  value_name: "EnableFirewall"
  expected_state:
    operator: "eq"
    value: 1
  remediate_type: "registry_set"
  set_value: 1
  set_type: "DWORD"
  post_reboot_required: false
  reference: "Annexure A Page 5, Item 5.a.i"
- id: "A.5.a.ii"
  title: "Block inbound connections for Private profile"
  description: "Ensure Windows Firewall: Private: Inbound connections is set to Block (default)"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile"
  value_name: "DefaultInboundAction"
  expected_state:
    operator: "eq"
    value: 1
  remediate_type: "registry_set"
  set_value: 1
  set_type: "DWORD"
  post_reboot_required: false
  reference: "Annexure A Page 5, Item 5.a.ii"
- id: "A.5.a.iii"
  title: "Allow outbound connections for Private profile"
  description: "Ensure Windows Firewall: Private: Outbound connections is set to Allow (default)"
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile"
  value_name: "DefaultOutboundAction"
  expected_state:
    operator: "eq"
    value: 0
  remediate_type: "registry_set"
  set_value: 0
  set_type: "DWORD"
  post_reboot_required: false
  reference: "Annexure A Page 5, Item 5.a.iii"
- id: "A.5.a.iv"
  title: "Disable notification for Private profile"
  description: "Ensure Windows Firewall: Private: Settings: Display a notification is set to No"
  platform: "windows"
  severity: "low"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile"
  value_name: "DisableNotifications"
  expected_state:
    operator: "eq"
    value: 1
  remediate_type: "registry_set"
  set_value: 1
  set_type: "DWORD"
  post_reboot_required: false
  reference: "Annexure A Page 5, Item 5.a.iv"
- id: "A.5.a.v"
  title: "Configure Private profile log file name"
  description: "Ensure Windows Firewall: Private: Logging: Name is set to %SystemRoot%\\System32\\logfiles\\firewall\\privatefw.log"
  platform: "windows"
  severity: "low"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging"
  value_name: "LogFilePath"
  expected_state:
    operator: "eq"
    value: "%SystemRoot%\\System32\\logfiles\\firewall\\privatefw.log"
  remediate_type: "registry_set"
  set_value: "%SystemRoot%\\System32\\logfiles\\firewall\\privatefw.log"
  set_type: "STRING"
  post_reboot_required: false
  reference: "Annexure A Page 5, Item 5.a.v"
- id: "A.5.a.vi"
  title: "Configure Private profile log size limit"
  description: "Ensure Windows Firewall: Private: Logging: Size limit (KB) is set to 16,384 KB or greater"
  platform: "windows"
  severity: "low"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging"
  value_name: "LogFileSize"
  expected_state:
    operator: "gte"
    value: 16384
  remediate_type: "registry_set"
  set_value: 16384
  set_type: "DWORD"
  post_reboot_required: false
  reference: "Annexure A Page 5, Item 5.a.vi"
- id: "A.5.a.vii"
  title: "Enable logging of dropped packets for Private profile"
  description: "Ensure Windows Firewall: Private: Logging: Log dropped packets is set to Yes"
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging"
  value_name: "LogDroppedPackets"
  expected_state:
    operator: "eq"
    value: 1
  remediate_type: "registry_set"
  set_value: 1
  set_type: "DWORD"
  post_reboot_required: false
  reference: "Annexure A Page 5, Item 5.a.vii"
- id: "A.5.a.viii"
  title: "Enable logging of successful connections for Private profile"
  description: "Ensure Windows Firewall: Private: Logging: Log successful connections is set to Yes"
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging"
  value_name: "LogSuccessfulConnections"
  expected_state:
    operator: "eq"
    value: 1
  remediate_type: "registry_set"
  set_value: 1
  set_type: "DWORD"
  post_reboot_required: false
  reference: "Annexure A Page 5, Item 5.a.viii"
- id: "A.5.b.i"
  title: "Enable Windows Firewall for Public profile"
  description: "Ensure Windows Firewall: Public: Firewall state is set to On (recommended)"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile"
  value_name: "EnableFirewall"
  expected_state:
    operator: "eq"
    value: 1
  remediate_type: "registry_set"
  set_value: 1
  set_type: "DWORD"
  post_reboot_required: false
  reference: "Annexure A Page 5, Item 5.b.i"
- id: "A.5.b.ii"
  title: "Block inbound connections for Public profile"
  description: "Ensure Windows Firewall: Public: Inbound connections is set to Block (default)"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile"
  value_name: "DefaultInboundAction"
  expected_state:
    operator: "eq"
    value: 1
  remediate_type: "registry_set"
  set_value: 1
  set_type: "DWORD"
  post_reboot_required: false
  reference: "Annexure A Page 5, Item 5.b.ii"
- id: "A.5.b.iii"
  title: "Allow outbound connections for Public profile"
  description: "Ensure Windows Firewall: Public: Outbound connections is set to Allow (default)"
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile"
  value_name: "DefaultOutboundAction"
  expected_state:
    operator: "eq"
    value: 0
  remediate_type: "registry_set"
  set_value: 0
  set_type: "DWORD"
  post_reboot_required: false
  reference: "Annexure A Page 5, Item 5.b.iii"
- id: "A.5.b.iv"
  title: "Disable notification for Public profile"
  description: "Ensure Windows Firewall: Public: Settings: Display a notification is set to No"
  platform: "windows"
  severity: "low"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile"
  value_name: "DisableNotifications"
  expected_state:
    operator: "eq"
    value: 1
  remediate_type: "registry_set"
  set_value: 1
  set_type: "DWORD"
  post_reboot_required: false
  reference: "Annexure A Page 5, Item 5.b.iv"
- id: "A.5.b.v"
  title: "Disable local firewall rules for Public profile"
  description: "Ensure Windows Firewall: Public: Settings: Apply local firewall rules is set to No"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile"
  value_name: "AllowLocalPolicyMerge"
  expected_state:
    operator: "eq"
    value: 0
  remediate_type: "registry_set"
  set_value: 0
  set_type: "DWORD"
  post_reboot_required: false
  reference: "Annexure A Page 5, Item 5.b.v"
- id: "A.5.b.vi"
  title: "Disable local connection security rules for Public profile"
  description: "Ensure Windows Firewall: Public: Settings: Apply local connection security rules is set to No"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile"
  value_name: "AllowLocalIPsecPolicyMerge"
  expected_state:
    operator: "eq"
    value: 0
  remediate_type: "registry_set"
  set_value: 0
  set_type: "DWORD"
  post_reboot_required: false
  reference: "Annexure A Page 5, Item 5.b.vi"
- id: "A.5.b.vii"
  title: "Configure Public profile log file name"
  description: "Ensure Windows Firewall: Public: Logging: Name is set to %SystemRoot%\\System32\\logfiles\\firewall\\publicfw.log"
  platform: "windows"
  severity: "low"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging"
  value_name: "LogFilePath"
  expected_state:
    operator: "eq"
    value: "%SystemRoot%\\System32\\logfiles\\firewall\\publicfw.log"
  remediate_type: "registry_set"
  set_value: "%SystemRoot%\\System32\\logfiles\\firewall\\publicfw.log"
  set_type: "STRING"
  post_reboot_required: false
  reference: "Annexure A Page 5, Item 5.b.vii"
- id: "A.5.b.viii"
  title: "Configure Public profile log size limit"
  description: "Ensure Windows Firewall: Public: Logging: Size limit (KB) is set to 16,384 KB or greater"
  platform: "windows"
  severity: "low"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging"
  value_name: "LogFileSize"
  expected_state:
    operator: "gte"
    value: 16384
  remediate_type: "registry_set"
  set_value: 16384
  set_type: "DWORD"
  post_reboot_required: false
  reference: "Annexure A Page 5, Item 5.b.viii"
- id: "A.5.b.ix"
  title: "Enable logging of dropped packets for Public profile"
  description: "Ensure Windows Firewall: Public: Logging: Log dropped packets is set to Yes"
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging"
  value_name: "LogDroppedPackets"
  expected_state:
    operator: "eq"
    value: 1
  remediate_type: "registry_set"
  set_value: 1
  set_type: "DWORD"
  post_reboot_required: false
  reference: "Annexure A Page 5, Item 5.b.ix"
- id: "A.5.b.x"
  title: "Enable logging of successful connections for Public profile"
  description: "Ensure Windows Firewall: Public: Logging: Log successful connections is set to Yes"
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging"
  value_name: "LogSuccessfulConnections"
  expected_state:
    operator: "eq"
    value: 1
  remediate_type: "registry_set"
  set_value: 1
  set_type: "DWORD"
  post_reboot_required: false
  reference: "Annexure A Page 5, Item 5.b.x"
- id: "A.6.a.i"
  title: "Audit Credential Validation"
  description: "Ensure Audit Credential Validation is set to Success and Failure"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "local_policy"
  policy_name: "AuditCredentialValidation"
  expected_state: "3"
  remediate_type: "local_policy_set"
  set_value: "3"
  post_reboot_required: false
  reference: "Annexure A Page 6, Item 6.a.i"
- id: "A.6.a.ii"
  title: "Audit Application Group Management"
  description: "Ensure Audit Application Group Management is set to Success and Failure"
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "local_policy"
  policy_name: "AuditApplicationGroupManagement"
  expected_state: "3"
  remediate_type: "local_policy_set"
  set_value: "3"
  post_reboot_required: false
  reference: "Annexure A Page 6, Item 6.a.ii"
- id: "A.6.a.iii"
  title: "Audit Security Group Management"
  description: "Ensure Audit Security Group Management is set to include Success"
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "local_policy"
  policy_name: "AuditSecurityGroupManagement"
  expected_state:
    operator: "gte"
    value: 1
  remediate_type: "local_policy_set"
  set_value: "3"
  post_reboot_required: false
  reference: "Annexure A Page 6, Item 6.a.iii"
- id: "A.6.a.iv"
  title: "Audit User Account Management"
  description: "Ensure Audit User Account Management is set to Success and Failure"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "local_policy"
  policy_name: "AuditUserAccountManagement"
  expected_state: "3"
  remediate_type: "local_policy_set"
  set_value: "3"
  post_reboot_required: false
  reference: "Annexure A Page 6, Item 6.a.iv"
- id: "A.6.a.v"
  title: "Audit PNP Activity"
  description: "Ensure Audit PNP Activity is set to include Success"
  platform: "windows"
  severity: "low"
  reversible: true
  check_type: "local_policy"
  policy_name: "AuditPNPActivity"
  expected_state:
    operator: "gte"
    value: 1
  remediate_type: "local_policy_set"
  set_value: "1"
  post_reboot_required: false
  reference: "Annexure A Page 6, Item 6.a.v"
- id: "A.6.a.vi"
  title: "Audit Process Creation"
  description: "Ensure Audit Process Creation is set to include Success"
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "local_policy"
  policy_name: "AuditProcessCreation"
  expected_state:
    operator: "gte"
    value: 1
  remediate_type: "local_policy_set"
  set_value: "1"
  post_reboot_required: false
  reference: "Annexure A Page 6, Item 6.a.vi"
- id: "A.6.a.vii"
  title: "Audit Account Lockout"
  description: "Ensure Audit Account Lockout is set to include Failure"
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "local_policy"
  policy_name: "AuditAccountLockout"
  expected_state:
    operator: "gte"
    value: 2
  remediate_type: "local_policy_set"
  set_value: "2"
  post_reboot_required: false
  reference: "Annexure A Page 6, Item 6.a.vii"
- id: "A.6.a.viii"
  title: "Audit Other Logon/Logoff Events"
  description: "Ensure Audit Other Logon/Logoff Events is set to Success and Failure"
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "local_policy"
  policy_name: "AuditOtherLogonLogoffEvents"
  expected_state: "3"
  remediate_type: "local_policy_set"
  set_value: "3"
  post_reboot_required: false
  reference: "Annexure A Page 6, Item 6.a.viii"
- id: "A.6.a.ix"
  title: "Audit File Share"
  description: "Ensure Audit File Share is set to Success and Failure"
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "local_policy"
  policy_name: "AuditFileShare"
  expected_state: "3"
  remediate_type: "local_policy_set"
  set_value: "3"
  post_reboot_required: false
  reference: "Annexure A Page 6, Item 6.a.ix"
- id: "A.6.a.xi"
  title: "Audit Audit Policy Change"
  description: "Ensure Audit Audit Policy Change is set to include Success"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "local_policy"
  policy_name: "AuditPolicyChange"
  expected_state:
    operator: "gte"
    value: 1
  remediate_type: "local_policy_set"
  set_value: "3"
  post_reboot_required: false
  reference: "Annexure A Page 6, Item 6.a.xi"
- id: "A.6.a.xii"
  title: "Audit Other Policy Change Events"
  description: "Ensure Audit Other Policy Change Events is set to include Failure"
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "local_policy"
  policy_name: "AuditOtherPolicyChangeEvents"
  expected_state:
    operator: "gte"
    value: 2
  remediate_type: "local_policy_set"
  set_value: "2"
  post_reboot_required: false
  reference: "Annexure A Page 6, Item 6.a.xii"
- id: "A.6.a.xiii"
  title: "Audit Sensitive Privilege Use"
  description: "Ensure Audit Sensitive Privilege Use is set to Success and Failure"
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "local_policy"
  policy_name: "AuditSensitivePrivilegeUse"
  expected_state: "3"
  remediate_type: "local_policy_set"
  set_value: "3"
  post_reboot_required: false
  reference: "Annexure A Page 6, Item 6.a.xiii"
- id: "A.6.a.xiv"
  title: "Audit System Integrity"
  description: "Ensure Audit System Integrity is set to Success and Failure"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "local_policy"
  policy_name: "AuditSystemIntegrity"
  expected_state: "3"
  remediate_type: "local_policy_set"
  set_value: "3"
  post_reboot_required: false
  reference: "Annexure A Page 6, Item 6.a.xiv"
- id: "A.6.a.xv"
  title: "Prevent enabling lock screen camera"
  description: "Ensure Prevent enabling lock screen camera is set to Enabled"
  platform: "windows"
  severity: "low"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Personalization"
  value_name: "NoLockScreenCamera"
  expected_state:
    operator: "eq"
    value: 1
  remediate_type: "registry_set"
  set_value: 1
  set_type: "DWORD"
  post_reboot_required: false
  reference: "Annexure A Page 6, Item 6.a.xv"
- id: "A.6.a.xvi"
  title: "Configure SMB v1 client driver"
  description: "Ensure Configure SMB v1 client driver is set to Enabled: Disable driver (recommended)"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SYSTEM\\CurrentControlSet\\Services\\mrxsmb10"
  value_name: "Start"
  expected_state:
    operator: "eq"
    value: 4
  remediate_type: "registry_set"
  set_value: 4
  set_type: "DWORD"
  post_reboot_required: true
  reference: "Annexure A Page 6, Item 6.a.xvi"
- id: "A.6.a.xvii"
  title: "Configure SMB v1 server"
  description: "Ensure Configure SMB v1 server is set to Disabled"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\Parameters"
  value_name: "SMB1"
  expected_state:
    operator: "eq"
    value: 0
  remediate_type: "registry_set"
  set_value: 0
  set_type: "DWORD"
  post_reboot_required: true
  reference: "Annexure A Page 6, Item 6.a.xvii"
- id: "A.6.b.i"
  title: "Disallow Autoplay for non-volume devices"
  description: "Ensure Disallow Autoplay for non-volume devices is set to Enabled"
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer"
  value_name: "NoAutoplayfornonVolume"
  expected_state:
    operator: "eq"
    value: 1
  remediate_type: "registry_set"
  set_value: 1
  set_type: "DWORD"
  post_reboot_required: false
  reference: "Annexure A Page 6, Item 6.b.i"
- id: "A.6.b.ii"
  title: "Set the default behaviour for AutoRun"
  description: "Ensure Set the default behaviour for AutoRun is set to Enabled: Do not execute any autorun commands"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer"
  value_name: "NoAutorun"
  expected_state:
    operator: "eq"
    value: 1
  remediate_type: "registry_set"
  set_value: 1
  set_type: "DWORD"
  post_reboot_required: false
  reference: "Annexure A Page 6, Item 6.b.ii"
- id: "A.6.b.iii"
  title: "Turn off Autoplay"
  description: "Ensure Turn off Autoplay is set to Enabled: All drives"
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer"
  value_name: "NoDriveTypeAutoRun"
  expected_state:
    operator: "eq"
    value: 255
  remediate_type: "registry_set"
  set_value: 255
  set_type: "DWORD"
  post_reboot_required: false
  reference: "Annexure A Page 6, Item 6.b.iii"
- id: "A.7.a"
  title: "Allow auditing events in Microsoft Defender Application Guard"
  description: "Ensure Allow auditing events in Microsoft Defender Application Guard is set to Enabled"
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SOFTWARE\\Policies\\Microsoft\\AppHVSI"
  value_name: "AuditApplicationGuard"
  expected_state:
    operator: "eq"
    value: 1
  remediate_type: "registry_set"
  set_value: 1
  set_type: "DWORD"
  post_reboot_required: false
  reference: "Annexure A Page 7, Item 7.a"
- id: "A.7.b"
  title: "Disable camera and microphone in Microsoft Defender Application Guard"
  description: "Ensure Allow camera and microphone access in Microsoft Defender Application Guard is set to Disabled"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SOFTWARE\\Policies\\Microsoft\\AppHVSI"
  value_name: "AllowCameraMicrophoneRedirection"
  expected_state:
    operator: "eq"
    value: 0
  remediate_type: "registry_set"
  set_value: 0
  set_type: "DWORD"
  post_reboot_required: false
  reference: "Annexure A Page 7, Item 7.b"
- id: "A.7.c"
  title: "Disable data persistence in Microsoft Defender Application Guard"
  description: "Ensure Allow data persistence for Microsoft Defender Application Guard is set to Disabled"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SOFTWARE\\Policies\\Microsoft\\AppHVSI"
  value_name: "AllowPersistence"
  expected_state:
    operator: "eq"
    value: 0
  remediate_type: "registry_set"
  set_value: 0
  set_type: "DWORD"
  post_reboot_required: false
  reference: "Annexure A Page 7, Item 7.c"
- id: "A.7.d"
  title: "Disable file download to host in Microsoft Defender Application Guard"
  description: "Ensure Allow files to download and save to the host operating system from Microsoft Defender Application Guard is set to Disabled"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SOFTWARE\\Policies\\Microsoft\\AppHVSI"
  value_name: "SaveFilesToHost"
  expected_state:
    operator: "eq"
    value: 0
  remediate_type: "registry_set"
  set_value: 0
  set_type: "DWORD"
  post_reboot_required: false
  reference: "Annexure A Page 7, Item 7.d"
- id: "A.7.e"
  title: "Configure clipboard settings for Microsoft Defender Application Guard"
  description: "Ensure Configure Microsoft Defender Application Guard clipboard settings is set to Enabled: Enable clipboard operation from an isolated session to the host"
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "registry_key"
  target_path: "HKLM\\SOFTWARE\\Policies\\Microsoft\\AppHVSI"
  value_name: "AppHVSIClipboardSettings"
  expected_state:
    operator: "eq"
    value: 1
  remediate_type: "registry_set"
  set_value: 1
  set_type: "DWORD"
  post_reboot_required: false
  reference: "Annexure A Page 7, Item 7.e"
- id: "A.2.sm1"
  title: "Disable SMBv1 Protocol"
  description: "Ensure SMBv1 is disabled to prevent exploitation of legacy protocol vulnerabilities"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "registry"
  registry_path: "HKLM:\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\Parameters"
  value_name: "SMB1"
  expected_state: "0"
  remediate_type: "registry_set"
  set_value: "0"
  post_reboot_required: true
  reference: "Mapped from Secure Configurations SC.2 (Disable unnecessary protocols) :contentReference[oaicite:2]{index=2}"
- id: "A.2.fw1"
  title: "Ensure Windows Firewall is Enabled"
  description: "Verify Windows Firewall is active across all profiles"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "powershell"
  command: "Get-NetFirewallProfile | Select-Object -ExpandProperty Enabled"
  expected_state:
    operator: "eq"
    value: 1
  remediate_type: "powershell_run"
  remediate_command: "Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled True"
  post_reboot_required: false
  reference: "Network & Email Security NES.1 – Deploy firewalls :contentReference[oaicite:3]{index=3}"
- id: "A.2.prt1"
  title: "Block Unused and Unsafe Ports"
  description: "Enumerate listening ports and ensure non-baseline ports are blocked"
  platform: "windows"
  severity: "medium"
  reversible: true
  check_type: "powershell"
  command: "Get-NetTCPConnection | Select-Object LocalPort"
  expected_state:
    operator: "eq"
    value: "baseline_port_list"
  remediate_type: "firewall_block"
  set_value: "block_nonbaseline"
  post_reboot_required: false
  reference: "Secure Configurations SC.2 – Disable unnecessary ports/services :contentReference[oaicite:4]{index=4}"
- id: "A.2.tls1"
  title: "Enforce TLS 1.2 and TLS 1.3"
  description: "Disable weak protocols TLS1.0/1.1 and ensure TLS1.2+ is enabled"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "registry"
  registry_path: "HKLM:\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\SCHANNEL\\Protocols"
  expected_state:
    operator: "eq"
    value: "TLS1.2_enabled"
  remediate_type: "registry_multiple"
  set_value:
    disable_TLS1_0: true
    disable_TLS1_1: true
    enable_TLS1_2: true
  post_reboot_required: true
  reference: "Cryptographic Practices – avoid outdated crypto & secure protocol configuration :contentReference[oaicite:5]{index=5}"
- id: "A.2.ciph1"
  title: "Disable Weak Cipher Suites"
  description: "Remove RC4, DES, 3DES, EXPORT, NULL and MD5-based cipher suites"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "powershell"
  command: "Get-TlsCipherSuite | Select-Object Name"
  expected_state: "no_weak_ciphers"
  remediate_type: "registry_set"
  set_value: "strong_cipher_list"
  post_reboot_required: true
  reference: "Cryptographic Practices – avoid outdated algorithms :contentReference[oaicite:6]{index=6}"
- id: "A.2.acc1"
  title: "Disable Guest and Anonymous Access Accounts"
  description: "Ensure Guest account and anonymous SID enumeration are disabled"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "local_policy"
  policy_name: "Accounts: Guest account status"
  expected_state: "disabled"
  remediate_type: "local_policy_set"
  set_value: "0"
  post_reboot_required: false
  reference: "Access Control & Identity Management ACIM.1 – unique IDs only, no shared/guest accounts :contentReference[oaicite:7]{index=7}"
- id: "A.2.priv1"
  title: "Restrict Dangerous Privileges from Local Accounts"
  description: "Remove SeDebugPrivilege, SeImpersonatePrivilege and SeBackupPrivilege from non-admin accounts"
  platform: "windows"
  severity: "high"
  reversible: true
  check_type: "privilege_enum"
  privilege_list:
    - SeDebugPrivilege
    - SeImpersonatePrivilege
    - SeBackupPrivilege
  expected_state: "assigned_to_admins_only"
  remediate_type: "secedit_update"
  set_value: "remove_from_non_admins"
  post_reboot_required: false
  reference: "Principle of Least Privilege – SC.1, ACIM.2, ACIM.4 :contentReference[oaicite:8]{index=8}"
